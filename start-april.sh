#!/bin/bash
echo "????? ???? ????????? ????????????..."

# Check Docker is installed
if ! command -v docker &> /dev/null; then
    echo "? Docker ???????????????. ??????? Docker ?????????."
    exit 1
fi

# Check Docker Compose
if ! command -v docker-compose &> /dev/null; then
    echo "? Docker Compose ???????????????."
    exit 1
fi

# Create necessary directories
mkdir -p my-tamil-documents audio-cache vector-db

# Check if documents exist
if [ ! -f "my-tamil-documents/??????????.txt" ]; then
    echo "?? ?????? ????? ????? ??????? ??????????????..."
    cat > my-tamil-documents/??????????.txt << 'EOF'
??? ????????? ??????????:

??? ?????:
- ?????????? ????: ???????????
- ?????????? ??????: ?????? ?????????
- ???????????????: ??????? ?????

?????????:
- ????? ?????? ???????????: 15?? ????
- ???? ???????????: 5?? ????
- ???????? ????????: 20?? ????

???????? ?????????:
- ????? ???????? ??????
- ???????? ??????
- ??? ??????????
EOF
    echo "? ?????? ????? ????????????????"
fi

# Build and start
echo "??? Docker ?????? ?????????????..."
docker-compose build

echo "?? ????????? ????????????..."
docker-compose up -d

echo ""
echo "========================================"
echo "? ????? ???? ????????? ???????????!"
echo "========================================"
echo ""
echo "?? ??? ????????: http://localhost:8501"
echo "?? ?????? ????????: ./my-tamil-documents/"
echo ""
echo "???????? ??????????:"
echo "1. ???? ????? ????????? (Voice mode)"
echo "2. ?????? ???????????? ????? ?????????"
echo "3. ???????? ????? ????????? (Stop)"
echo ""
echo "?????????? ???????: docker-compose logs -f"
echo "???????: docker-compose down"
echo "========================================"